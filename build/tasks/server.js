// Generated by CoffeeScript 1.3.3
/*global module, require
*/

module.exports = function(grunt) {
  return grunt.registerMultiTask('server', 'Run a server', function() {
    var config, done, options, port, src, target, watch, _ref;
    done = this.async();
    src = this.file.src;
    target = this.target;
    config = this.data;
    watch = (_ref = config.watch) != null ? _ref : false;
    port = config.port;
    if (watch) {
      options = ['"' + './node_modules/.bin/nodemon' + '"', src, '-w', src, port];
    } else {
      options = ['node', src, port];
    }
    grunt.log.write("starting \"" + target + "\" web server at \"http://localhost:" + port + "\"");
    return grunt.helper('exec', "" + (options.join(' ')), true, true, function(err) {
      if (err) {
        grunt.log.write(err);
        return done(false);
      } else {
        return done(true);
      }
    });
  });
};
